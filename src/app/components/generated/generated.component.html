<div
    *ngIf="($data | async) as data"
    [ngSwitch]="data.status"
    content
>
    <ng-template [ngSwitchCase]="status.GENERATED">
        <app-overlay
            [src]="data.source.raw_src"
            [attr.real-size]="screen == screens.FIT_SCREEN ? '1' : null"
            [attr.show]="mode == modes.SOURCE ? '1' : null"
            (singleClick)="toggleFit($event)"
        ></app-overlay>
        <div
            class="spacer toggle"
            (click)="toggleFit($event)"
        ></div>
        <app-prompt
            *ngIf="prompt"
            [data]="prompt"
        ></app-prompt>
        <div info>
            <div timestamp>{{data.last_modified | amTimeAgo}}</div>
            <button
                mat-icon-button
                (click)="onReplay($event, data.slug)"
            >
                <mat-icon>replay</mat-icon>
            </button>
            <div class="spacer"></div>
            <button
                mat-icon-button
                (click)="onDownload($event, data.image.raw_src, data.slug)"
            >
                <mat-icon>download</mat-icon>
            </button>
            <button
                mat-icon-button
                (click)="onPrompt($event)"
            >
                <mat-icon>data_object</mat-icon>
            </button>
            <button
                mat-icon-button
                (click)="onMode($event)"
            >
                <mat-icon>
                    {{mode == modes.SOURCE ? 'image' : 'person'}}
                </mat-icon>
            </button>
            <button
                type="button"
                mat-icon-button
                (click)="onScreen($event)"
            >
                <mat-icon>
                    {{ screen == screens.FIT_SCREEN ? 'fullscreen' : 'fit_screen' }}
                </mat-icon>
            </button>
        </div>
    </ng-template>
    <ng-template [ngSwitchCase]="status.ERROR">
        <div
            class="spacer"
            (click)="toggleFit($event)"
        ></div>
        <div
            [attr.status]="data.status"
            status-line
        >
            <div label>{{data.status}}</div>
        </div>
        <div class="spacer"></div>
        <div info>
            <div timestamp>{{data.last_modified | amTimeAgo}}</div>
            <div class="spacer"></div>
        </div>
    </ng-template>
    <ng-template [ngSwitchCase]="status.IN_PROGRESS">
        <app-loading [entity]="data">In Progress</app-loading>
    </ng-template>

    <ng-template [ngSwitchDefault]>
        <div
            class="spacer"
            (click)="toggleFit($event)"
        ></div>
        <div
            [attr.status]="data.status"
            status-line
        >
            <div label>{{data.status}}</div>
        </div>
        <div class="spacer"></div>
        <div info>
            <div timestamp>{{data.last_modified | amTimeAgo}}</div>
        </div>
    </ng-template>
</div>
